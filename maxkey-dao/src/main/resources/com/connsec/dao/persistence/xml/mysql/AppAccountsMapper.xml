<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.connsec.dao.persistence.AppAccountsMapper">

	<sql id="where_statement">
    	<if test="id != null and id != ''">
			AND	ID	=	#{id}
		</if> 
		<if test="appId != null and appId != ''">
			AND	APPID	=	#{appId}
		</if> 
		<if test="username != null and username != ''">
			AND	USERNAME	=	#{username}
		</if> 
		<if test="relatedUsername != null and relatedUsername != ''">
			AND	RELATEDUSERNAME	=	#{relatedUsername}
		</if> 
    </sql>
    
	<insert id="insert" parameterType="AppAccounts">
		INSERT INTO APP_ACCOUNTS(
			ID,
			UID,
			USERNAME,
			DISPLAYNAME,
			APPID,
			APPNAME,
			RELATEDUSERNAME,
			RELATEDPASSWORD
		)VALUES(
			#{id},
			#{uid},
			#{username},
			#{displayName},
			#{appId},
			#{appName},
			#{relatedUsername},
			#{relatedPassword}
		)
	</insert>
	
	<select id="grid" parameterType="AppAccounts" resultType="AppAccounts">
		SELECT
			*
		FROM
			APP_ACCOUNTS
		WHERE
			 (1=1)	
		<include refid="where_statement"/>
	</select>
	
	<select id="count" parameterType="AppAccounts" resultType="java.lang.Integer">
		SELECT
			COUNT(*) 
		FROM
			APP_ACCOUNTS
		WHERE
			 (1=1)	
		<include refid="where_statement"/>
	</select>
	
	<update id="update" parameterType="AppAccounts" >
    	UPDATE APP_ACCOUNTS SET
    		RELATEDUSERNAME		= 	#{relatedUsername},
    		RELATEDPASSWORD		=	#{relatedPassword},
			MODIFIEDDATE	=	current_timestamp()
    	WHERE 
			UID		=	#{uid} 
			AND APPID	=	#{appId} 
    </update>
    
    <select id="load" parameterType="AppAccounts" resultType="AppAccounts">
    	SELECT 
			*
    	FROM 
    		APP_ACCOUNTS 
    	WHERE 	
    		UID		=	#{uid}  
    		AND  APPID	=	#{appId} 
    </select>
    
    <select id="get" parameterType="string" resultType="AppAccounts">
    	SELECT 
			*
    	FROM 
    		APP_ACCOUNTS 
    	WHERE 	
    		ID		=	#{id}  
    </select>
    
    <delete id="remove" parameterType="string" >
    	DELETE FROM APP_ACCOUNTS WHERE ID=#{value}
    </delete>
</mapper>