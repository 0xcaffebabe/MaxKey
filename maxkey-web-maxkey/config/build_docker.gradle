buildscript {
	repositories {
		jcenter()
		maven { url 'http://maven.aliyun.com/nexus/content/groups/public/'}
	}
}

plugins {
	id 'java'
	id 'com.google.cloud.tools.jib' version "${jibGradlePluginVersion}"
	id 'org.springframework.boot' version "${springBootVersion}"
}

apply plugin: 'com.google.cloud.tools.jib'

description = "maxkey-web-maxkey"

//docker
jib {
	from {
		image = 'openjdk:8-jre-alpine'
	}
	to {
		//https://registry.hub.docker.com/repository/docker/maxkeytop/maxkey
		image = "maxkeytop/maxkey"
		tags = ["${project.version}".toString(), 'latest']
		auth {
			username = "maxkeytop"
			password = "password"
		}
	}
	container {
		mainClass 	= "org.maxkey.MaxKeyApplication"
		jvmFlags 	= ['-Dfile.encoding=utf-8', '-Dserver.port=443','-Duser.timezone=Asia/Shanghai']
		ports 		= ['443']
	}
}

dependencies {
	compile project(":maxkey-common")
	compile project(":maxkey-core")
	compile project(":maxkey-persistence")
   	
   	compile project(":maxkey-authentications:maxkey-authentication-core")
   	compile project(":maxkey-authentications:maxkey-authentication-social")
   	compile project(":maxkey-authentications:maxkey-authentication-captcha")
   	compile project(":maxkey-authentications:maxkey-authentication-otp")
   	
   	compile project(":maxkey-protocols:maxkey-protocol-authorize")
   	compile project(":maxkey-protocols:maxkey-protocol-cas")
	compile project(":maxkey-protocols:maxkey-protocol-desktop")
	compile project(":maxkey-protocols:maxkey-protocol-extendapi")
	compile project(":maxkey-protocols:maxkey-protocol-formbased")
	compile project(":maxkey-protocols:maxkey-protocol-tokenbased")
   	compile project(":maxkey-protocols:maxkey-protocol-oauth-2.0")
   	compile project(":maxkey-protocols:maxkey-protocol-saml-2.0")
	compile project(":maxkey-protocols:maxkey-protocol-jwt")
	
}
